local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Key sistemi değişkenleri
local correctKey = "OnyxHubPre"
local keyVerified = false

-- Key giriş GUI
local keyGui = Instance.new("ScreenGui")
keyGui.Name = "KeyGui"
keyGui.ResetOnSpawn = false
keyGui.Parent = playerGui

local keyFrame = Instance.new("Frame")
keyFrame.Name = "KeyFrame"
keyFrame.Size = UDim2.new(0, 350, 0, 200)
keyFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
keyFrame.AnchorPoint = Vector2.new(0.5, 0.5)
keyFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
keyFrame.BorderSizePixel = 0
keyFrame.Parent = keyGui

local keyTitle = Instance.new("TextLabel")
keyTitle.Name = "KeyTitle"
keyTitle.Size = UDim2.new(1, 0, 0, 40)
keyTitle.BackgroundTransparency = 1
keyTitle.Text = "ONYX HUB - KEY GİRİŞ"
keyTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
keyTitle.Font = Enum.Font.GothamBlack
keyTitle.TextSize = 20
keyTitle.Parent = keyFrame

local keyInput = Instance.new("TextBox")
keyInput.Name = "KeyInput"
keyInput.Size = UDim2.new(0.8, 0, 0, 40)
keyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
keyInput.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
keyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
keyInput.PlaceholderText = "Key girin..."
keyInput.Font = Enum.Font.Gotham
keyInput.TextSize = 16
keyInput.Parent = keyFrame

local submitButton = Instance.new("TextButton")
submitButton.Name = "SubmitButton"
submitButton.Size = UDim2.new(0.8, 0, 0, 40)
submitButton.Position = UDim2.new(0.1, 0, 0.6, 0)
submitButton.BackgroundColor3 = Color3.fromRGB(0, 90, 180)
submitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
submitButton.Text = "KEY ONAYLA"
submitButton.Font = Enum.Font.GothamBold
submitButton.TextSize = 16
submitButton.Parent = keyFrame

local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(0.8, 0, 0, 20)
statusLabel.Position = UDim2.new(0.1, 0, 0.8, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = ""
statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 14
statusLabel.Parent = keyFrame

-- Key doğrulama fonksiyonu
local function verifyKey()
    local enteredKey = keyInput.Text
    if enteredKey == correctKey then
        keyVerified = true
        keyGui.Enabled = false
        statusLabel.Text = ""
        statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        statusLabel.Text = "Key doğrulandı! Menü açılıyor..."
        wait(1)
        keyGui:Destroy()
        createMainGui() -- Ana menüyü oluştur
    else
        statusLabel.Text = "Hatalı key! Tekrar deneyin."
        keyInput.Text = ""
    end
end

-- Key giriş eventleri
submitButton.MouseButton1Click:Connect(verifyKey)
keyInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        verifyKey()
    end
end)

-- ESP için değişkenler
local espEnabled = false
local espConnections = {}
local espObjects = {}

-- ESP fonksiyonları
local function createESP(plr)
    if plr == player then return end
    
    local function updateESP()
        if not espEnabled or not plr.Character then
            if espObjects[plr] then
                espObjects[plr]:Destroy()
                espObjects[plr] = nil
            end
            return
        end
        
        local humanoidRootPart = plr.Character:FindFirstChild("HumanoidRootPart")
        local humanoid = plr.Character:FindFirstChildOfClass("Humanoid")
        
        if not humanoidRootPart or not humanoid or humanoid.Health <= 0 then
            if espObjects[plr] then
                espObjects[plr]:Destroy()
                espObjects[plr] = nil
            end
            return
        end
        
        -- Mesafe hesaplama
        local distance = "N/A"
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            distance = tostring(math.floor((humanoidRootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude)) .. " stud"
        end
        
        -- ESP text oluştur veya güncelle
        if not espObjects[plr] then
            local billboard = Instance.new("BillboardGui")
            billboard.Name = plr.Name .. "ESP"
            billboard.Adornee = humanoidRootPart
            billboard.Size = UDim2.new(0, 200, 0, 50)
            billboard.StudsOffset = Vector3.new(0, 3, 0)
            billboard.AlwaysOnTop = true
            billboard.MaxDistance = 1000
            billboard.Parent = playerGui
            
            local textLabel = Instance.new("TextLabel")
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.BackgroundTransparency = 1
            textLabel.Text = plr.Name .. "\n" .. distance
            textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            textLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            textLabel.TextStrokeTransparency = 0
            textLabel.Font = Enum.Font.GothamBold
            textLabel.TextSize = 14
            textLabel.Parent = billboard
            
            espObjects[plr] = billboard
        else
            espObjects[plr].TextLabel.Text = plr.Name .. "\n" .. distance
        end
    end
    
    -- ESP güncelleme connection'ı
    local conn
    if espEnabled then
        conn = RunService.Heartbeat:Connect(updateESP)
    end
    espConnections[plr] = conn
end

local function removeESP(plr)
    if espConnections[plr] then
        espConnections[plr]:Disconnect()
        espConnections[plr] = nil
    end
    if espObjects[plr] then
        espObjects[plr]:Destroy()
        espObjects[plr] = nil
    end
end

local function toggleESP()
    espEnabled = not espEnabled
    
    if espEnabled then
        -- Tüm oyuncular için ESP oluştur
        for _, plr in ipairs(Players:GetPlayers()) do
            createESP(plr)
        end
        
        -- Yeni oyuncular için dinleyici ekle
        espConnections.playerAdded = Players.PlayerAdded:Connect(function(plr)
            createESP(plr)
        end)
        
        -- Oyuncu çıkışları için dinleyici ekle
        espConnections.playerRemoving = Players.PlayerRemoving:Connect(function(plr)
            removeESP(plr)
        end)
    else
        -- Tüm ESP'leri temizle
        for plr, _ in pairs(espObjects) do
            removeESP(plr)
        end
        
        -- Connection'ları temizle
        if espConnections.playerAdded then
            espConnections.playerAdded:Disconnect()
            espConnections.playerAdded = nil
        end
        if espConnections.playerRemoving then
            espConnections.playerRemoving:Disconnect()
            espConnections.playerRemoving = nil
        end
    end
end

-- Ana menüyü oluşturma fonksiyonu
function createMainGui()
    -- Ana menü GUI
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AdvancedMenu"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = playerGui

    -- ONYX HUB BAŞLIK (Sol üstte)
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "OnyxHubTitle"
    titleLabel.Size = UDim2.new(0, 150, 0, 30)
    titleLabel.Position = UDim2.new(0, 20, 0, 20)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "ONYX HUB"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.Font = Enum.Font.GothamBlack
    titleLabel.TextSize = 20
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = screenGui

    -- Açma/Kapama butonu (Başlığın yanına)
    local toggleButton = Instance.new("TextButton")
    toggleButton.Name = "ToggleButton"
    toggleButton.Size = UDim2.new(0, 50, 0, 50)
    toggleButton.Position = UDim2.new(0, 180, 0, 20)
    toggleButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.Text = "≡"
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.TextSize = 24
    toggleButton.Parent = screenGui

    -- Ana menü frame
    local menuFrame = Instance.new("Frame")
    menuFrame.Name = "MainMenu"
    menuFrame.Size = UDim2.new(0.5, 0, 0.6, 0)
    menuFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    menuFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    menuFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    menuFrame.Visible = false
    menuFrame.Parent = screenGui

    -- Sol sayfa geçiş butonları
    local pageButtonsFrame = Instance.new("Frame")
    pageButtonsFrame.Name = "PageButtons"
    pageButtonsFrame.Size = UDim2.new(0.15, 0, 1, 0)
    pageButtonsFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    pageButtonsFrame.Parent = menuFrame

    -- Sayfa 1 butonu (Kişisel)
    local page1Button = Instance.new("TextButton")
    page1Button.Name = "Page1Button"
    page1Button.Size = UDim2.new(1, -10, 0.12, 0)
    page1Button.Position = UDim2.new(0, 5, 0.1, 0)
    page1Button.BackgroundColor3 = Color3.fromRGB(0, 90, 180)
    page1Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    page1Button.Text = "Kişisel"
    page1Button.Font = Enum.Font.Gotham
    page1Button.TextSize = 14
    page1Button.Parent = pageButtonsFrame

    -- Sayfa 2 butonu (Evrensel)
    local page2Button = Instance.new("TextButton")
    page2Button.Name = "Page2Button"
    page2Button.Size = UDim2.new(1, -10, 0.12, 0)
    page2Button.Position = UDim2.new(0, 5, 0.25, 0)
    page2Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    page2Button.TextColor3 = Color3.fromRGB(200, 200, 200)
    page2Button.Text = "Evrensel"
    page2Button.Font = Enum.Font.Gotham
    page2Button.TextSize = 14
    page2Button.Parent = pageButtonsFrame

    -- Sayfa 3 butonu (ESP)
    local page3Button = Instance.new("TextButton")
    page3Button.Name = "Page3Button"
    page3Button.Size = UDim2.new(1, -10, 0.12, 0)
    page3Button.Position = UDim2.new(0, 5, 0.4, 0)
    page3Button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    page3Button.TextColor3 = Color3.fromRGB(200, 200, 200)
    page3Button.Text = "ESP"
    page3Button.Font = Enum.Font.Gotham
    page3Button.TextSize = 14
    page3Button.Parent = pageButtonsFrame

    -- Sayfa içerik alanı
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(0.85, 0, 1, 0)
    contentFrame.Position = UDim2.new(0.15, 0, 0, 0)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = menuFrame

    -- Sayfa 1 içeriği (Kişisel)
    local page1Frame = Instance.new("Frame")
    page1Frame.Name = "Page1"
    page1Frame.Size = UDim2.new(1, 0, 1, 0)
    page1Frame.BackgroundTransparency = 1
    page1Frame.Visible = true
    page1Frame.Parent = contentFrame

    -- Tıkla Işınlan butonu (Sayfa 1)
    local teleportButton = Instance.new("TextButton")
    teleportButton.Name = "TeleportButton"
    teleportButton.Size = UDim2.new(0.8, 0, 0.15, 0)
    teleportButton.Position = UDim2.new(0.1, 0, 0.2, 0)
    teleportButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    teleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    teleportButton.Text = "Tıkla Işınlan: KAPALI"
    teleportButton.Font = Enum.Font.Gotham
    teleportButton.TextSize = 18
    teleportButton.Parent = page1Frame

    -- NoClip butonu (Sayfa 1)
    local noclipButton = Instance.new("TextButton")
    noclipButton.Name = "NoClipButton"
    noclipButton.Size = UDim2.new(0.8, 0, 0.15, 0)
    noclipButton.Position = UDim2.new(0.1, 0, 0.4, 0)
    noclipButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    noclipButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    noclipButton.Text = "NoClip: KAPALI"
    noclipButton.Font = Enum.Font.Gotham
    noclipButton.TextSize = 18
    noclipButton.Parent = page1Frame

    -- Hız Ayarlı butonu (Sayfa 1)
    local speedButton = Instance.new("TextButton")
    speedButton.Name = "SpeedButton"
    speedButton.Size = UDim2.new(0.8, 0, 0.15, 0)
    speedButton.Position = UDim2.new(0.1, 0, 0.6, 0)
    speedButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    speedButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    speedButton.Text = "Hız Ayarla: 16 (Varsayılan)"
    speedButton.Font = Enum.Font.Gotham
    speedButton.TextSize = 18
    speedButton.Parent = page1Frame

    -- Hız giriş kutusu (Sayfa 1)
    local speedInput = Instance.new("TextBox")
    speedInput.Name = "SpeedInput"
    speedInput.Size = UDim2.new(0.8, 0, 0.1, 0)
    speedInput.Position = UDim2.new(0.1, 0, 0.8, 0)
    speedInput.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    speedInput.TextColor3 = Color3.fromRGB(255, 255, 255)
    speedInput.Text = "16"
    speedInput.Font = Enum.Font.Gotham
    speedInput.TextSize = 16
    speedInput.PlaceholderText = "Hız değeri girin (örn: 50)"
    speedInput.Visible = false
    speedInput.Parent = page1Frame

    -- Sınırsız Zıplama butonu (Sayfa 1)
    local infJumpButton = Instance.new("TextButton")
    infJumpButton.Name = "InfJumpButton"
    infJumpButton.Size = UDim2.new(0.8, 0, 0.15, 0)
    infJumpButton.Position = UDim2.new(0.1, 0, 0.8, 0)
    infJumpButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    infJumpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    infJumpButton.Text = "Sınırsız Zıplama: KAPALI"
    infJumpButton.Font = Enum.Font.Gotham
    infJumpButton.TextSize = 18
    infJumpButton.Parent = page1Frame

    -- Sayfa 2 içeriği (Evrensel)
    local page2Frame = Instance.new("Frame")
    page2Frame.Name = "Page2"
    page2Frame.Size = UDim2.new(1, 0, 1, 0)
    page2Frame.BackgroundTransparency = 1
    page2Frame.Visible = false
    page2Frame.Parent = contentFrame

    -- Oyuncu listesi başlığı
    local playerListLabel = Instance.new("TextLabel")
    playerListLabel.Name = "PlayerListLabel"
    playerListLabel.Size = UDim2.new(0.8, 0, 0.1, 0)
    playerListLabel.Position = UDim2.new(0.1, 0, 0.05, 0)
    playerListLabel.BackgroundTransparency = 1
    playerListLabel.Text = "Oyuncu Listesi:"
    playerListLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    playerListLabel.Font = Enum.Font.Gotham
    playerListLabel.TextSize = 18
    playerListLabel.TextXAlignment = Enum.TextXAlignment.Left
    playerListLabel.Parent = page2Frame

    -- Arama kutusu
    local searchBox = Instance.new("TextBox")
    searchBox.Name = "SearchBox"
    searchBox.Size = UDim2.new(0.6, 0, 0.1, 0)
    searchBox.Position = UDim2.new(0.1, 0, 0.15, 0)
    searchBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    searchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    searchBox.PlaceholderText = "Oyuncu ara..."
    searchBox.Font = Enum.Font.Gotham
    searchBox.TextSize = 16
    searchBox.Parent = page2Frame

    -- Refresh butonu
    local refreshButton = Instance.new("TextButton")
    refreshButton.Name = "RefreshButton"
    refreshButton.Size = UDim2.new(0.2, 0, 0.1, 0)
    refreshButton.Position = UDim2.new(0.7, 0, 0.15, 0)
    refreshButton.BackgroundColor3 = Color3.fromRGB(0, 90, 180)
    refreshButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    refreshButton.Text = "Yenile"
    refreshButton.Font = Enum.Font.Gotham
    refreshButton.TextSize = 16
    refreshButton.Parent = page2Frame

    -- Oyuncu listesi ScrollingFrame
    local playerListFrame = Instance.new("ScrollingFrame")
    playerListFrame.Name = "PlayerListFrame"
    playerListFrame.Size = UDim2.new(0.8, 0, 0.5, 0)
    playerListFrame.Position = UDim2.new(0.1, 0, 0.25, 0)
    playerListFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    playerListFrame.BackgroundTransparency = 0.5
    playerListFrame.BorderSizePixel = 0
    playerListFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    playerListFrame.ScrollingDirection = Enum.ScrollingDirection.Y
    playerListFrame.Parent = page2Frame

    -- Oyuncu listesi UIListLayout
    local playerListLayout = Instance.new("UIListLayout")
    playerListLayout.Name = "PlayerListLayout"
    playerListLayout.Padding = UDim.new(0, 5)
    playerListLayout.Parent = playerListFrame

    -- Işınlanma butonu
    local teleportToPlayerButton = Instance.new("TextButton")
    teleportToPlayerButton.Name = "TeleportToPlayerButton"
    teleportToPlayerButton.Size = UDim2.new(0.8, 0, 0.1, 0)
    teleportToPlayerButton.Position = UDim2.new(0.1, 0, 0.8, 0)
    teleportToPlayerButton.BackgroundColor3 = Color3.fromRGB(0, 90, 180)
    teleportToPlayerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    teleportToPlayerButton.Text = "Seçili Oyuncuya Işınlan"
    teleportToPlayerButton.Font = Enum.Font.GothamBold
    teleportToPlayerButton.TextSize = 18
    teleportToPlayerButton.Parent = page2Frame

    -- Sayfa 3 içeriği (ESP)
    local page3Frame = Instance.new("Frame")
    page3Frame.Name = "Page3"
    page3Frame.Size = UDim2.new(1, 0, 1, 0)
    page3Frame.BackgroundTransparency = 1
    page3Frame.Visible = false
    page3Frame.Parent = contentFrame

    -- ESP başlığı
    local espTitle = Instance.new("TextLabel")
    espTitle.Name = "ESPTitle"
    espTitle.Size = UDim2.new(0.8, 0, 0.1, 0)
    espTitle.Position = UDim2.new(0.1, 0, 0.1, 0)
    espTitle.BackgroundTransparency = 1
    espTitle.Text = "ESP AYARLARI"
    espTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    espTitle.Font = Enum.Font.GothamBold
    espTitle.TextSize = 20
    espTitle.Parent = page3Frame

    -- ESP Aç/Kapa butonu
    local espToggleButton = Instance.new("TextButton")
    espToggleButton.Name = "ESPToggleButton"
    espToggleButton.Size = UDim2.new(0.8, 0, 0.15, 0)
    espToggleButton.Position = UDim2.new(0.1, 0, 0.3, 0)
    espToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    espToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    espToggleButton.Text = "ESP: KAPALI"
    espToggleButton.Font = Enum.Font.Gotham
    espToggleButton.TextSize = 18
    espToggleButton.Parent = page3Frame

    -- ESP açıklama
    local espDescription = Instance.new("TextLabel")
    espDescription.Name = "ESPDescription"
    espDescription.Size = UDim2.new(0.8, 0, 0.3, 0)
    espDescription.Position = UDim2.new(0.1, 0, 0.5, 0)
    espDescription.BackgroundTransparency = 1
    espDescription.Text = "ESP özelliği açıldığında tüm oyuncuların üstünde isimleri ve size olan uzaklıkları görünecektir."
    espDescription.TextColor3 = Color3.fromRGB(200, 200, 200)
    espDescription.Font = Enum.Font.Gotham
    espDescription.TextSize = 14
    espDescription.TextWrapped = true
    espDescription.Parent = page3Frame

    -- Değişkenler
    local isMenuOpen = false
    local teleportActive = false
    local noclipActive = false
    local speedActive = false
    local infJumpActive = false
    local teleportConnection = nil
    local noclipConnection = nil
    local infJumpConnection = nil
    local currentPage = 1
    local selectedPlayer = nil
    local defaultWalkSpeed = 16
    local currentWalkSpeed = defaultWalkSpeed

    -- Oyuncu listesini güncelle (Filtreleme ile)
    local function updatePlayerList(searchTerm)
        playerListFrame:ClearAllChildren()
        
        local players = Players:GetPlayers()
        playerListFrame.CanvasSize = UDim2.new(0, 0, 0, #players * 35)
        
        for _, plr in ipairs(players) do
            if not searchTerm or string.find(string.lower(plr.Name), string.lower(searchTerm)) then
                local playerButton = Instance.new("TextButton")
                playerButton.Name = plr.Name
                playerButton.Size = UDim2.new(1, -10, 0, 30)
                playerButton.BackgroundColor3 = (plr == player) and Color3.fromRGB(80, 80, 80) or 
                                              (plr == selectedPlayer) and Color3.fromRGB(0, 120, 255) or 
                                              Color3.fromRGB(60, 60, 60)
                playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                playerButton.Text = plr.Name .. (plr == player and " (Siz)" or "")
                playerButton.Font = Enum.Font.Gotham
                playerButton.TextSize = 14
                playerButton.Parent = playerListFrame
                
                if plr ~= player then
                    playerButton.MouseButton1Click:Connect(function()
                        selectedPlayer = plr
                        updatePlayerList(searchBox.Text)
                    end)
                end
            end
        end
    end

    -- Tween ile ışınlanma
    local function teleportToPlayer()
        if not selectedPlayer or not selectedPlayer.Character then 
            print("Hata: Geçerli bir oyuncu seçilmedi!")
            return 
        end
        if not player.Character then return end
        
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
        local targetChar = selectedPlayer.Character
        local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
        
        if not humanoid or not rootPart or not targetRoot then return end
        
        local distance = (rootPart.Position - targetRoot.Position).Magnitude
        local duration = distance / 150
        
        local tweenInfo = TweenInfo.new(
            duration,
            Enum.EasingStyle.Linear
        )
        
        local tween = TweenService:Create(rootPart, tweenInfo, {CFrame = targetRoot.CFrame})
        tween:Play()
    end

    -- Hız ayarlama fonksiyonu
    local function setWalkSpeed()
        if not player.Character then return end
        
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        if not humanoid then return end
        
        local speed = tonumber(speedInput.Text)
        if speed and speed > 0 then
            currentWalkSpeed = speed
            humanoid.WalkSpeed = speed
            speedButton.Text = "Hız Ayarla: " .. speed .. " (Ayarlı)"
        else
            speedInput.Text = tostring(defaultWalkSpeed)
            currentWalkSpeed = defaultWalkSpeed
            humanoid.WalkSpeed = defaultWalkSpeed
            speedButton.Text = "Hız Ayarla: " .. defaultWalkSpeed .. " (Varsayılan)"
        end
    end

    -- Hız ayarlarını aç/kapa
    local function toggleSpeedInput()
        speedActive = not speedActive
        speedInput.Visible = speedActive
        
        if speedActive then
            speedButton.Text = "Hızı Uygula"
            speedInput:CaptureFocus()
        else
            setWalkSpeed()
        end
    end

    -- Sınırsız zıplama fonksiyonu
    local function toggleInfJump()
        infJumpActive = not infJumpActive
        infJumpButton.Text = infJumpActive and "Sınırsız Zıplama: AÇIK" or "Sınırsız Zıplama: KAPALI"
        
        if infJumpActive then
            infJumpConnection = UserInputService.JumpRequest:Connect(function()
                if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
                    player.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                end
            end)
        elseif infJumpConnection then
            infJumpConnection:Disconnect()
            infJumpConnection = nil
        end
    end

    -- ESP aç/kapa fonksiyonu
    local function toggleESPButton()
        toggleESP()
        espToggleButton.Text = espEnabled and "ESP: AÇIK" or "ESP: KAPALI"
    end

    -- Sayfa geçiş fonksiyonu
    local function switchPage(pageNum)
        currentPage = pageNum
        page1Frame.Visible = (pageNum == 1)
        page2Frame.Visible = (pageNum == 2)
        page3Frame.Visible = (pageNum == 3)
        
        if pageNum == 2 then
            updatePlayerList(searchBox.Text)
        end
        
        -- Buton renklerini güncelle
        page1Button.BackgroundColor3 = (pageNum == 1) and Color3.fromRGB(0, 90, 180) or Color3.fromRGB(40, 40, 40)
        page1Button.TextColor3 = (pageNum == 1) and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(200, 200, 200)
        page2Button.BackgroundColor3 = (pageNum == 2) and Color3.fromRGB(0, 90, 180) or Color3.fromRGB(40, 40, 40)
        page2Button.TextColor3 = (pageNum == 2) and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(200, 200, 200)
        page3Button.BackgroundColor3 = (pageNum == 3) and Color3.fromRGB(0, 90, 180) or Color3.fromRGB(40, 40, 40)
        page3Button.TextColor3 = (pageNum == 3) and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(200, 200, 200)
    end

    -- Menüyü aç/kapa
    local function toggleMenu()
        isMenuOpen = not isMenuOpen
        menuFrame.Visible = isMenuOpen
        toggleButton.Text = isMenuOpen and "X" or "≡"
        
        if isMenuOpen then
            switchPage(1)
        end
    end

    -- Işınlanma fonksiyonu (Sayfa 1)
    local function teleportPlayer()
        if not player.Character then return end
        
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
        
        if not humanoid or not rootPart then return end
        
        local target = player:GetMouse().Hit.Position
        rootPart.CFrame = CFrame.new(target + Vector3.new(0, 3, 0))
    end

    -- Tıkla Işınlanı aç/kapa
    local function toggleTeleport()
        teleportActive = not teleportActive
        teleportButton.Text = teleportActive and "Tıkla Işınlan: AÇIK" or "Tıkla Işınlan: KAPALI"
        
        if teleportActive then
            teleportConnection = UserInputService.InputBegan:Connect(function(input, processed)
                if not processed and (input.UserInputType == Enum.UserInputType.MouseButton1 or 
                                     input.UserInputType == Enum.UserInputType.Touch) then
                    teleportPlayer()
                end
            end)
        elseif teleportConnection then
            teleportConnection:Disconnect()
            teleportConnection = nil
        end
    end

    -- NoClip fonksiyonu
    local function toggleNoclip()
        noclipActive = not noclipActive
        noclipButton.Text = noclipActive and "NoClip: AÇIK" or "NoClip: KAPALI"
        
        if noclipActive then
            noclipConnection = RunService.Stepped:Connect(function()
                if player.Character then
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                end
            end)
        elseif noclipConnection then
            noclipConnection:Disconnect()
            noclipConnection = nil
            
            if player.Character then
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = true
                    end
                end
            end
        end
    end

    -- Oyuncu değişikliklerini takip et
    Players.PlayerAdded:Connect(function() updatePlayerList(searchBox.Text) end)
    Players.PlayerRemoving:Connect(function() updatePlayerList(searchBox.Text) end)

    -- Arama kutusu dinleyici
    searchBox:GetPropertyChangedSignal("Text"):Connect(function()
        updatePlayerList(searchBox.Text)
    end)

    -- Buton eventleri
    toggleButton.MouseButton1Click:Connect(toggleMenu)
    teleportButton.MouseButton1Click:Connect(toggleTeleport)
    noclipButton.MouseButton1Click:Connect(toggleNoclip)
    speedButton.MouseButton1Click:Connect(toggleSpeedInput)
    infJumpButton.MouseButton1Click:Connect(toggleInfJump)
    espToggleButton.MouseButton1Click:Connect(toggleESPButton)
    page1Button.MouseButton1Click:Connect(function() switchPage(1) end)
    page2Button.MouseButton1Click:Connect(function() switchPage(2) end)
    page3Button.MouseButton1Click:Connect(function() switchPage(3) end)
    teleportToPlayerButton.MouseButton1Click:Connect(teleportToPlayer)
    refreshButton.MouseButton1Click:Connect(function() updatePlayerList(searchBox.Text) end)

    -- Hız giriş kutusu eventleri
    speedInput.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            toggleSpeedInput()
        end
    end)

    -- Karakter değiştiğinde ayarları güncelle
    player.CharacterAdded:Connect(function(character)
        if noclipActive then
            toggleNoclip()
            toggleNoclip()
        end
        
        if infJumpActive then
            toggleInfJump()
            toggleInfJump()
        end
        
        local humanoid = character:WaitForChildOfClass("Humanoid")
        humanoid.WalkSpeed = currentWalkSpeed
    end)
end
